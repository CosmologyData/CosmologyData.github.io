title: 一些代码片段
date: 2016-04-30 01:51:05
tags:
---

### 发布订阅者模式

```javascript
var Observer = function () {

};

Observer.prototype = {
  constructor: Observer,
  subscribe: function (eventName, func) {
    if (!this[eventName]) this[eventName] = [];
    this[eventName].push(func);
  },
  publish: function (eventName, data) {
    var _this = this;
    if (!this[eventName]) this[eventName] = [];
    this[eventName].forEach(function (func) {
      func.call(_this, data);
    });
  }
};

var ob = new Observer();
// 订阅
ob.subscribe('dialog', function (data) {
  console.log('there are data:' + data);
});
// 发布
ob.publish('dialog', [1, 2, 3, 4]);
```

### 解析多层属性，类似angularJS的$parse服务

```javascript
var parse = function (agm) {
  agm = agm.split('.');

  return function (target, undefined) {
    var result = undefined;
    (function parseTarget(target, agm) {
      if (target === undefined) {
        console.error('Uncaught TypeError: Cannot read property ' + agm[0] + ' of undefined');
        result = target;
        return result;
      }
      if (agm.length <= 1) {
        result = target[agm[0]];
        return result;
      }
      target = target[agm[0]];
      agm.shift();
      parseTarget(target, agm)
    })(target, agm);

    return result;
  }
};


var o = {
  a: {
    b: {
      c: 233
    }
  }
};

var r = parse('a.b.c')(o);

console.log(r);   // 233

```
